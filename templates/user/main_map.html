<html lang="ja">
<head>
    <title>MAP</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../../static/css/style.css">
    <script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
    <style>
        .container{
            position: relative;
        }
        .hantei{
            position: absolute;
            font-size: 30px;
            color: red;
        }
        #pop{
            position: absolute;
            top: 400px;;
            left: 350px;; 
        }
        #openBlock{
            display:none;
            position: absolute;
        }
        .Bbule{ margin-right: 85%;}
    </style>
</head>
<body>
    <div class="container">
        <!-- map表示 -->
        <!-- Image Map Generated by http://www.image-map.net/ -->
        <div class="hantei">{{hantei}}</div>
        <img src="../static/images/map.png" usemap="#image-map">
        <map name="image-map">
            <div id="stage">
                <area target="_self" alt="1-1" title="1-1" data-stage="1-1" data-url="{{ url_for('story_1') }}" id="stage1_1" onclick="setBounds('stage1_1')" coords="323,600,428,670" shape="rect">
                <area target="_self" alt="1-2" title="1-2" data-stage="1-2" data-url="{{ url_for('main_quiz2') }}" id="stage1_2" onclick="setBounds('stage1_2')" coords="486,558,603,624" shape="rect">
                <area target="_self" alt="1-3" title="1-3" data-stage="1-3" data-url="{{ url_for('main_quiz3') }}" id="stage1_3" onclick="setBounds('stage1_3')" coords="642,617,785,694" shape="rect">
                <area target="_self" alt="1-4" title="1-4" data-stage="1-4" data-url="{{ url_for('main_quiz4') }}" id="stage1_4" onclick="setBounds('stage1_4')" coords="833,578,944,643" shape="rect">
                <area target="_self" alt="1-5" title="1-5" data-stage="1-5" data-url="{{ url_for('story_5') }}" id="stage1_5" onclick="setBounds('stage1_5')" coords="1015,607,1187,682" shape="rect">
                <area target="_self" alt="scroll" title="scroll" href="{{ url_for('main_map_2') }}" coords="1149,300,1149,390,1216,343" shape="poly">
            </div>
        </map>
        <!--キャラクター-->
        <div id="chara" style="position: absolute;">
            <a href="#" id="message">ステージをクリック！</a>
            <img src="../static/images/syukatsu_man.png">
        </div>
        
        <a href="{{ url_for('findworktop')}}" class="na">戻る</a>
    </div>

    <script type="text/javascript">
        var flag = {{flag|tojson}};
        // キャラクター初期配置
        document.getElementById("chara").style.left = 150;
        document.getElementById("chara").style.top = 430;
        // キャラクター移動
        var hoge = document.getElementById('stage').getAttribute('data-stage');
        function setBounds(hoge){
            console.log(hoge)
            let url = document.getElementById(hoge).dataset.url
            console.log(url)
			switch(hoge){
                case 'stage1_1':
                        document.getElementById("chara").style.left = 320;
                        document.getElementById("chara").style.top = 420;
                        document.getElementById("message").textContent = "1-1"
                        document.getElementById("message").setAttribute('href', url);
                        break
                case 'stage1_2':
                    if(flag>=1){
                        document.getElementById("chara").style.left = 490;
                        document.getElementById("chara").style.top = 380;
                        document.getElementById("message").textContent = "1-2"
                        document.getElementById("message").setAttribute('href', url);
                        console.log(flag)
                        break
                    }
                case 'stage1_3':
                    if(flag>=2){
                        document.getElementById("chara").style.left = 660;
                        document.getElementById("chara").style.top = 430;
                        document.getElementById("message").textContent = "1-3"
                        document.getElementById("message").setAttribute('href', url);
                        break
                    }
                case 'stage1_4':
                    if(flag>=3){
                        document.getElementById("chara").style.left = 830;
                        document.getElementById("chara").style.top = 400;
                        document.getElementById("message").textContent = "1-4"
                        document.getElementById("message").setAttribute('href', url);
                        break
                    }
                case 'stage1_5':
                    if(flag>=4){
                        document.getElementById("chara").style.left = 1000;
                        document.getElementById("chara").style.top = 430;
                        document.getElementById("message").textContent = "1-5"
                        document.getElementById("message").setAttribute('href', url);
                        break
                    }
                }
		}
        // 戦闘画面移行
        $('#stage').click(function(){
            $('#openBlock').toggle();
        })
    </script>
</body>
</html>